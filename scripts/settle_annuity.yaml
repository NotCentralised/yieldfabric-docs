commands:
  # START FUNDING COUNTERPART
  - name: issuer_deposit
    type: deposit
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      asset_id: aud-token-asset
      amount: 125
      idempotency_key: deposit-$(date +%s)

  - name: issuer_send_1
    type: instant
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      asset_id: aud-token-asset
      amount: 100
      idempotency_key: instant-$(date +%s)
      destination_id: counterpart@yieldfabric.com

  - name: counterpart_accept_1
    type: accept
    user: 
      id: counterpart@yieldfabric.com
      password: counterpass789
    parameters:
      idempotency_key: accept-$(date +%s)
      payment_id: $issuer_send_1.payment_id

  # START CREATING ANNUITY

  - name: issuer_annuity_stream_obligation_1
    type: create_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      idempotency_key: create_annuity_stream_obligation-ergonomic-$(date +%s)
      counterpart: issuer@yieldfabric.com
      denomination: aud-token-asset
      obligor: issuer@yieldfabric.com
      notional: 5 
      expiry: 2025-12-01
      data: 
        name: "Annuity Stream"
        description: "Annuity Stream Obligation"
      initial_payments:
        amount: 5
        payments:
          - id: payment-1
            payer:
              unlock: 2025-12-01
            payee:
              unlock: 2025-12-01

          - id: payment-2
            payer:
              unlock: 2025-12-02
            payee:
              unlock: 2025-12-02

          - id: payment-3
            payer:
              unlock: 2025-12-03
            payee:
              unlock: 2025-12-03

          - id: payment-4
            payer:
              unlock: 2025-12-04
            payee:
              unlock: 2025-12-04

          - id: payment-5
            payer:
              unlock: 2025-12-05
            payee:
              unlock: 2025-12-05

  - name: issuer_accept_annuity_stream_obligation_1
    type: accept_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      idempotency_key: accept_annuity_stream_obligation-ergonomic-$(date +%s)
      contract_id: $issuer_annuity_stream_obligation_1.contract_id


  - name: issuer_redemption_obligation_1
    type: create_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      idempotency_key: create_redemption_obligation-ergonomic-$(date +%s)
      counterpart: issuer@yieldfabric.com
      denomination: aud-token-asset
      obligor: issuer@yieldfabric.com
      notional: 100
      expiry: 2025-12-01
      data: 
        name: "Redemption"
        description: "Redemption Obligation"
      initial_payments:
        amount: 100
        payments:
          - id: payment-1
            payer:
              unlock: 2025-12-06
            payee:
              unlock: 2025-12-06

  - name: issuer_accept_redemption_obligation_1
    type: accept_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      idempotency_key: accept_redemption_obligation-ergonomic-$(date +%s)
      contract_id: $issuer_redemption_obligation_1.contract_id


  # START ANNUITY SETTLEMENT
  - name: create_obligation_swap-1
    type: create_swap
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      swap_id: "123456789"
      idempotency_key: swap-ergonomic-$(date +%s)
      initiator:
        obligation_ids:
          - $issuer_annuity_stream_obligation_1.contract_id
          - $issuer_redemption_obligation_1.contract_id

      counterparty:
        id: counterpart@yieldfabric.com
        expected_payments:
          denomination: aud-token-asset
          amount: 100
          payments:
            - id: swap-payment-1
      deadline: 2025-12-10

  - name: complete_swap-1
    type: complete_swap
    user: 
      id: counterpart@yieldfabric.com
      password: counterpass789
    parameters:
      swap_id: "123456789"
      idempotency_key: complete-swap-ergonomic-$(date +%s)
      # expected_payments:
      #   denomination: aud-token-asset
      #   amount: 100
      #   payments:
      #     - id: swap-payment-1
      
  # - name: cancel_swap-1
  #   type: cancel_swap
  #   user: 
  #     id: admin2@yieldfabric.com
  #     password: testpass123
  #     group: Admin Group
  #   parameters:
  #     swap_id: "1234567890"
  #     key: "cancel_key"
  #     value: "cancel_value"
  #     idempotency_key: cancel-swap-ergonomic-$(date +%s)


  - name: counterpart_accept_1
    type: accept_all
    user: 
      id: counterpart@yieldfabric.com
      password: counterpass789
    parameters:
      idempotency_key: accept-$(date +%s)
      denomination: aud-token-asset

  - name: issuer_accept_1
    type: accept_all
    user: 
      id: issuer@yieldfabric.com
      password: issuerpass456
    parameters:
      idempotency_key: accept-$(date +%s)
      denomination: aud-token-asset


