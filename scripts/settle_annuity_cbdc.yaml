commands:
  # START FUNDING COUNTERPART
  # - name: issuer_deposit_send-1
  #   type: composed_operation
  #   user: 
  #     id: issuer@yieldfabric.com
  #     password: issuer_password
  #   parameters:
  #     idempotency_key: issuer_deposit_send-ergonomic-$(date +%s)
  #     operations:
  #       # Operation 1: Deposit
  #       - operation_type: deposit
  #         operation_data:
  #           asset_id: cbdc-token-asset
  #           amount: 125
  #       # Operation 2: Send
  #       - operation_type: instant
  #         operation_data:
  #           asset_id: cbdc-token-asset
  #           amount: 100
  #           destination_id: investor@yieldfabric.com

  - name: issuer_deposit
    type: deposit
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      asset_id: cbdc-token-asset
      amount: 1250000
      idempotency_key: deposit-$(date +%s)

  - name: issuer_send_1
    type: instant
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      asset_id: cbdc-token-asset
      amount: 1000000
      idempotency_key: instant-$(date +%s)
      destination_id: investor@yieldfabric.com

  - name: counterpart_accept_1
    type: accept
    user: 
      id: investor@yieldfabric.com
      password: investor_password
    parameters:
      idempotency_key: accept-$(date +%s)
      payment_id: $issuer_send_1.payment_id

  # START CREATING ANNUITY

  - name: issuer_annuity_stream_obligation_1
    type: create_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      idempotency_key: create_annuity_stream_obligation-ergonomic-$(date +%s)
      counterpart: issuer@yieldfabric.com
      denomination: cbdc-token-asset
      obligor: issuer@yieldfabric.com
      expiry: 2025-12-20
      data: 
        name: "Annuity Stream"
        description: "Annuity Stream Obligation"
      initial_payments:
        amount: 500
        payments:
          - id: payment-1
            payer:
              unlock: 2025-12-20
            payee:
              unlock: 2025-12-20

          - id: payment-2
            payer:
              unlock: 2025-12-21
            payee:
              unlock: 2025-12-21

          - id: payment-3
            payer:
              unlock: 2025-12-22
            payee:
              unlock: 2025-12-22

          - id: payment-4
            payer:
              unlock: 2025-12-23
            payee:
              unlock: 2025-12-23

          - id: payment-5
            payer:
              unlock: 2025-12-24
            payee:
              unlock: 2025-12-24

  - name: issuer_accept_annuity_stream_obligation_1
    type: accept_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      idempotency_key: accept_annuity_stream_obligation-ergonomic-$(date +%s)
      contract_id: $issuer_annuity_stream_obligation_1.contract_id


  - name: issuer_redemption_obligation_1
    type: create_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      idempotency_key: create_redemption_obligation-ergonomic-$(date +%s)
      counterpart: issuer@yieldfabric.com
      denomination: cbdc-token-asset
      obligor: issuer@yieldfabric.com
      notional: 1000000
      expiry: 2025-12-20
      data: 
        name: "Redemption"
        description: "Redemption Obligation"
      initial_payments:
        amount: 1000000
        payments:
          - id: payment-1
            payer:
              unlock: 2025-12-25
            payee:
              unlock: 2025-12-25

  - name: issuer_accept_redemption_obligation_1
    type: accept_obligation
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      idempotency_key: accept_redemption_obligation-ergonomic-$(date +%s)
      contract_id: $issuer_redemption_obligation_1.contract_id


  # START ANNUITY SETTLEMENT
  - name: create_obligation_swap-1
    type: create_swap
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      swap_id: "1123456789"
      idempotency_key: swap-ergonomic-$(date +%s)
      initiator:
        obligation_ids:
          - $issuer_annuity_stream_obligation_1.contract_id
          - $issuer_redemption_obligation_1.contract_id

      counterparty:
        id: investor@yieldfabric.com
        expected_payments:
          denomination: cbdc-token-asset
          amount: 1000000
          payments:
            - id: swap-payment-1
      deadline: 2025-12-20

  - name: complete_swap-1
    type: complete_swap
    user: 
      id: investor@yieldfabric.com
      password: investor_password
    parameters:
      swap_id: "1123456789"
      idempotency_key: complete-swap-ergonomic-$(date +%s)
      
  # - name: cancel_swap-1
  #   type: cancel_swap
  #   user: 
  #     id: admin2@yieldfabric.com
  #     password: testpass123
  #     group: Admin Group
  #   parameters:
  #     swap_id: "1234567890"
  #     key: "cancel_key"
  #     value: "cancel_value"
  #     idempotency_key: cancel-swap-ergonomic-$(date +%s)


  - name: counterpart_accept_1
    type: accept_all
    user: 
      id: investor@yieldfabric.com
      password: investor_password
    parameters:
      idempotency_key: accept-$(date +%s)
      denomination: cbdc-token-asset

  - name: issuer_accept_1
    type: accept_all
    user: 
      id: issuer@yieldfabric.com
      password: issuer_password
    parameters:
      idempotency_key: accept-$(date +%s)
      denomination: cbdc-token-asset


